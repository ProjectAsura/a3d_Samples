//-------------------------------------------------------------------------------------------------
// File : SampleAllocator.h
// Desc : Sample Allocator.
// Copyright(c) Project Asura. All right reserved.
//-------------------------------------------------------------------------------------------------
#pragma once

//-----------------------------------------------------------------------------
// Includes
//-----------------------------------------------------------------------------
#include <a3d.h>
#include <stdlib.h>


///////////////////////////////////////////////////////////////////////////////
// SampleAllocator class
///////////////////////////////////////////////////////////////////////////////
class SampleAllocator : public a3d::IAllocator
{
    //=========================================================================
    // list of friend classes and methods.
    //=========================================================================
    /* NONTHING */

public:
    //=========================================================================
    // public variables.
    //=========================================================================
    /* NOHTING */

    //=========================================================================
    // public methods.
    //=========================================================================

    //-------------------------------------------------------------------------
    //      メモリを確保します.
    //-------------------------------------------------------------------------
    void* Alloc(size_t size, size_t alignment) noexcept override
    {
        #if A3D_IS_WIN
            return _aligned_malloc(size, alignment);
        #else
            return aligned_alloc(alignment, size);
        #endif
    }

    //-------------------------------------------------------------------------
    //      メモリを再確保します.
    //-------------------------------------------------------------------------
    void* Realloc(void* ptr, size_t size, size_t alignment) noexcept override
    {
        #if A3D_IS_WIN
            return _aligned_realloc(ptr, size, alignment);
        #else
            return realloc(ptr, size);
        #endif
    }

    //---------------------------------------------------------------------------------------------
    //      メモリを解放します.
    //---------------------------------------------------------------------------------------------
    void Free(void* ptr) noexcept override
    {
        #if A3D_IS_WIN
            _aligned_free(ptr);
        #else
            free(ptr);
        #endif
    }
};
